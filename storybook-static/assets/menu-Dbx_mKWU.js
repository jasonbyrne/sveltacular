var Oe=Object.defineProperty;var ce=s=>{throw TypeError(s)};var Se=(s,e,t)=>e in s?Oe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var x=(s,e,t)=>Se(s,typeof e!="symbol"?e+"":e,t),Ce=(s,e,t)=>e.has(s)||ce("Cannot "+t);var p=(s,e,t)=>(Ce(s,e,"read from private field"),t?t.call(s):e.get(s)),q=(s,e,t)=>e.has(s)?ce("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import{i as P,j as de,g as i,h as O,p as qe,A as v,x as ae,f as b,k as M,l as V,b as n,c as Me,s as re,e as _,F as Pe,m as ne,C as ue,a as y,u as R,t as fe,ad as ve}from"./iframe-D7RYvwF5.js";import{e as ge,i as $e}from"./each-ldT_kV30.js";import{h as me,I as pe}from"./icon-v8TPefiR.js";import{s as z}from"./attributes-AHszVgQG.js";import{s as oe}from"./class-CSG4cUfb.js";import{s as ye}from"./style-OEUvFely.js";import{b as Ee}from"./this-p55_KPOp.js";import{F as X}from"./flex-item-vFOmLPoH.js";import{F as be}from"./flex-row-DqBsqYfl.js";var B,D,G,J,K;class Fe{constructor(e,t){x(this,"itemHeight");x(this,"overscan");x(this,"variableHeight");q(this,B,P(de([])));q(this,D,P(de([])));q(this,G,P(0));q(this,J,P(0));q(this,K,P(0));x(this,"containerRef",null);x(this,"heightCache",new Map);x(this,"scrollHandler",null);x(this,"resizeObserver",null);this.items=e,this.itemHeight=t.itemHeight,this.overscan=t.overscan??3,this.variableHeight=t.variableHeight??!1,this.calculateTotalHeight(),this.updateVisibleItems()}get items(){return i(p(this,B))}set items(e){O(p(this,B),e,!0)}get visibleItems(){return i(p(this,D))}set visibleItems(e){O(p(this,D),e,!0)}get totalHeight(){return i(p(this,G))}set totalHeight(e){O(p(this,G),e,!0)}get scrollTop(){return i(p(this,J))}set scrollTop(e){O(p(this,J),e,!0)}get containerHeight(){return i(p(this,K))}set containerHeight(e){O(p(this,K),e,!0)}setItems(e){this.items=e,this.heightCache.clear(),this.calculateTotalHeight(),this.updateVisibleItems()}setContainer(e){this.containerRef&&this.scrollHandler&&this.containerRef.removeEventListener("scroll",this.scrollHandler),this.resizeObserver&&this.resizeObserver.disconnect(),this.containerRef=e,e&&(this.scrollHandler=()=>{this.scrollTop=e.scrollTop,this.updateVisibleItems()},e.addEventListener("scroll",this.scrollHandler,{passive:!0}),this.resizeObserver=new ResizeObserver(t=>{for(const l of t)this.containerHeight=l.contentRect.height,this.updateVisibleItems()}),this.resizeObserver.observe(e),this.containerHeight=e.clientHeight,this.scrollTop=e.scrollTop,this.updateVisibleItems())}calculateTotalHeight(){if(this.variableHeight){let e=0;for(let t=0;t<this.items.length;t++)e+=this.heightCache.get(t)??this.itemHeight;this.totalHeight=e}else this.totalHeight=this.items.length*this.itemHeight}getItemHeight(e){return this.variableHeight?this.heightCache.get(e)??this.itemHeight:this.itemHeight}getItemOffsetTop(e){if(this.variableHeight){let t=0;for(let l=0;l<e;l++)t+=this.getItemHeight(l);return t}return e*this.itemHeight}findStartIndex(){if(this.variableHeight){let e=0,t=this.items.length-1;for(;e<=t;){const l=Math.floor((e+t)/2),o=this.getItemOffsetTop(l);if(o<this.scrollTop)e=l+1;else if(o>this.scrollTop)t=l-1;else return l}return Math.max(0,t)}return Math.floor(this.scrollTop/this.itemHeight)}updateVisibleItems(){if(this.items.length===0||this.containerHeight===0){this.visibleItems=[];return}const e=Math.max(0,this.findStartIndex()-this.overscan);let t;if(this.variableHeight){let o=0;t=e;const N=this.containerHeight+this.overscan*this.itemHeight*2;for(;t<this.items.length&&o<N;)o+=this.getItemHeight(t),t++}else{const o=Math.ceil(this.containerHeight/this.itemHeight);t=Math.min(this.items.length,e+o+this.overscan*2)}const l=[];for(let o=e;o<t;o++)l.push({index:o,data:this.items[o],offsetTop:this.getItemOffsetTop(o),height:this.getItemHeight(o)});this.visibleItems=l}setItemHeight(e,t){!this.variableHeight||this.heightCache.get(e)===t||(this.heightCache.set(e,t),this.calculateTotalHeight(),this.updateVisibleItems())}scrollToIndex(e,t="smooth"){if(!this.containerRef)return;const l=this.getItemOffsetTop(e);this.containerRef.scrollTo({top:l,behavior:t})}destroy(){this.containerRef&&this.scrollHandler&&this.containerRef.removeEventListener("scroll",this.scrollHandler),this.resizeObserver&&this.resizeObserver.disconnect()}}B=new WeakMap,D=new WeakMap,G=new WeakMap,J=new WeakMap,K=new WeakMap;function Le(s,e){return new Fe(s,e)}var Ae=b('<li class="instructions svelte-qdyg5s" role="presentation"> </li>'),je=b('<span class="check svelte-qdyg5s" aria-hidden="true"><!></span>'),Be=b("<!> <!>",1),De=b('<li role="option" class="svelte-qdyg5s"><div><!></div></li>'),Ge=b("<div></div>"),Je=b('<span class="check svelte-qdyg5s" aria-hidden="true"><!></span>'),Ke=b("<!> <!>",1),Ne=b('<li role="option" class="svelte-qdyg5s"><div><!></div></li>'),Qe=b('<ul role="listbox" aria-label="Options"><!> <!></ul>');function Ue(s,e){qe(e,!0);let t=v(e,"items",19,()=>[]),l=v(e,"value",15,null),o=v(e,"instructions",3,""),N=v(e,"open",15,!1),xe=v(e,"size",3,"full"),_e=v(e,"closeAfterSelect",3,!0),Q=v(e,"searchText",3,""),U=v(e,"highlightIndex",11,0),He=v(e,"onSelect",3,void 0),Y=v(e,"virtualScroll",3,!1),ke=v(e,"itemHeight",3,40),$=v(e,"listboxId",3,void 0);const W=a=>{var c;l(a.value!=null?String(a.value):null),(c=He())==null||c(a),_e()&&N(!1)},Ie=a=>{if(Y()&&i(u))i(u).scrollToIndex(a,"smooth");else{const c=document.querySelector(`[data-index="${a}"]`);c&&c.scrollIntoView({block:"nearest"})}};let S=null,u=P(null);ae(()=>{Y()?i(u)?i(u).setItems(t()):(O(u,Le(t(),{itemHeight:ke()}),!0),S&&i(u).setContainer(S)):i(u)&&(i(u).destroy(),O(u,null))}),ae(()=>{i(u)&&S&&i(u).setContainer(S)}),ae(()=>{U()>=0&&Ie(U())});var E=Qe(),he=_(E);{var Te=a=>{var c=Ae(),H=_(c);V(()=>ne(H,o())),n(a,c)};M(he,a=>{o()&&a(Te)})}var we=re(he,2);{var Ve=a=>{var c=Ge();ge(c,21,()=>i(u).visibleItems,H=>H.index,(H,C)=>{const f=ue(()=>i(C).data),k=ue(()=>i(C).index);var h=De();h.__click=()=>W(i(f));var F=_(h);let L;var Z=_(F);be(Z,{children:(ee,ze)=>{var A=Be(),j=y(A);X(j,{grow:!0,children:(I,ie)=>{var g=R(),T=y(g);{var w=r=>{var d=R(),se=y(d);me(se,()=>i(f).label.replace(new RegExp(Q(),"gi"),le=>`<strong>${le}</strong>`)),n(r,d)},m=r=>{var d=fe();V(()=>ne(d,i(f).label)),n(r,d)};M(T,r=>{Q()?r(w):r(m,!1)})}n(I,g)},$$slots:{default:!0}});var te=re(j,2);X(te,{children:(I,ie)=>{var g=R(),T=y(g);{var w=m=>{var r=je(),d=_(r);pe(d,{type:"check",size:"sm"}),n(m,r)};M(T,m=>{i(f).value===l()&&m(w)})}n(I,g)},$$slots:{default:!0}}),n(ee,A)},$$slots:{default:!0}}),V(()=>{z(h,"id",$()?`${$()}-option-${i(k)}`:void 0),z(h,"aria-selected",i(f).value===l()),z(h,"data-index",i(k)),ye(h,`position: absolute; top: ${i(C).offsetTop??""}px; height: ${i(C).height??""}px; width: 100%; box-sizing: border-box;`),L=oe(F,1,"svelte-qdyg5s",null,L,{selected:i(k)==U()})}),ve("keypress",h,()=>W(i(f))),n(H,h)}),V(()=>ye(c,`height: ${i(u).totalHeight??""}px; position: relative;`)),n(a,c)},Re=a=>{var c=R(),H=y(c);ge(H,17,t,$e,(C,f,k)=>{var h=Ne();h.__click=()=>W(i(f)),z(h,"data-index",k);var F=_(h);let L;var Z=_(F);be(Z,{children:(ee,ze)=>{var A=Ke(),j=y(A);X(j,{grow:!0,children:(I,ie)=>{var g=R(),T=y(g);{var w=r=>{var d=R(),se=y(d);me(se,()=>i(f).label.replace(new RegExp(Q(),"gi"),le=>`<strong>${le}</strong>`)),n(r,d)},m=r=>{var d=fe();V(()=>ne(d,i(f).label)),n(r,d)};M(T,r=>{Q()?r(w):r(m,!1)})}n(I,g)},$$slots:{default:!0}});var te=re(j,2);X(te,{children:(I,ie)=>{var g=R(),T=y(g);{var w=m=>{var r=Je(),d=_(r);pe(d,{type:"check",size:"sm"}),n(m,r)};M(T,m=>{i(f).value===l()&&m(w)})}n(I,g)},$$slots:{default:!0}}),n(ee,A)},$$slots:{default:!0}}),V(()=>{z(h,"id",$()?`${$()}-option-${k}`:void 0),z(h,"aria-selected",i(f).value===l()),L=oe(F,1,"svelte-qdyg5s",null,L,{selected:k==U()})}),ve("keypress",h,()=>W(i(f))),n(C,h)}),n(a,c)};M(we,a=>{Y()&&i(u)?a(Ve):a(Re,!1)})}Ee(E,a=>S=a,()=>S),V(()=>{z(E,"id",$()),oe(E,1,`menu ${N()?"open":"closed"} ${xe()??""}`,"svelte-qdyg5s")}),n(s,E),Me()}Pe(["click"]);Ue.__docgen={data:[{name:"items",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"ReferenceItem[]"},static:!1,readonly:!1,defaultValue:"..."},{name:"value",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"instructions",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'""'},{name:"open",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"..."},{name:"size",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"string",value:"xs",text:'"xs"'},{kind:"const",type:"string",value:"sm",text:'"sm"'},{kind:"const",type:"string",value:"md",text:'"md"'},{kind:"const",type:"string",value:"lg",text:'"lg"'},{kind:"const",type:"string",value:"xl",text:'"xl"'},{kind:"const",type:"string",value:"auto",text:'"auto"'},{kind:"const",type:"string",value:"full",text:'"full"'}],text:'"xs" | "sm" | "md" | "lg" | "xl" | "auto" | "full"'},static:!1,readonly:!1,defaultValue:'"full"'},{name:"closeAfterSelect",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"},{name:"searchText",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'""'},{name:"highlightIndex",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"..."},{name:"onSelect",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(item: ReferenceItem) => void"},static:!1,readonly:!1},{name:"virtualScroll",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"itemHeight",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"40"},{name:"listboxId",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1}],name:"menu.svelte"};export{Ue as M,Le as u};
