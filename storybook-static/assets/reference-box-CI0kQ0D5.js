import{p as we,A as n,i as u,j as B,x as W,f as C,a as E,b as c,c as _e,h as a,g as t,C as s,s as O,u as Ce,k as R,F as Ie,l as X,m as Y,e as A,ae as Ne,t as Z}from"./iframe-D7RYvwF5.js";import{k as Ve,u as $}from"./ucfirst-D2sS6U5O.js";import{s as Te}from"./attributes-AHszVgQG.js";import{b as Fe}from"./this-p55_KPOp.js";import{M as Re}from"./multi-select-base-BVBcCcU5.js";import{c as Me}from"./form-Dq9J9N2L.js";import{P as Se}from"./prompt-BhA4zG_Z.js";import{I as qe}from"./icon-v8TPefiR.js";var Le=C('<button type="button" class="create-new svelte-e9shgi" role="option"><!> <span class="svelte-e9shgi"><!></span></button>'),ze=C('<div class="create-error svelte-e9shgi" role="alert"> </div>'),Pe=C('<div class="creating-indicator svelte-e9shgi" aria-live="polite">Creating...</div>'),Be=C("<!> <!>",1),Ee=C("<!> <!>",1);function Oe(ee,i){we(i,!0);let y=n(i,"value",31,()=>B([])),D=n(i,"items",19,()=>[]),x=n(i,"fieldNames",3,void 0),m=n(i,"search",3,void 0),M=n(i,"createNew",3,void 0),j=n(i,"linkBuilder",3,void 0),p=n(i,"resourceName",3,void 0),te=n(i,"placeholder",3,"Search and add items..."),ae=n(i,"required",3,!1),ie=n(i,"disabled",3,!1),le=n(i,"size",3,"md"),ne=n(i,"label",3,void 0),re=n(i,"helperText",3,void 0),se=n(i,"feedback",3,void 0),de=n(i,"maxItems",3,void 0),oe=n(i,"onChange",3,void 0),K=u(null),h=u(B([])),S=u(!1),w=u(!1),q=u(!1),f=u(null),U=u(0),G=u("");const I=s(()=>Me(x())),ue=s(()=>x()?D().map(e=>t(I).toReferenceItem(e)):D());let v=u(B([]));W(()=>{x()?a(v,y().map(e=>t(I).toReferenceItem(e)),!0):a(v,y(),!0)});function H(e){var l;x()?y(e.map(r=>t(I).fromReferenceItem(r))):y(e),(l=oe())==null||l(y())}let fe=s(()=>m()?t(h):t(ue)),ce=s(()=>t(fe)),me=s(()=>({getLabel:e=>e.label,getKey:e=>String(e.value??e.label),equals:(e,l)=>e.value===l.value,fromMenuOption:e=>e,getLink:j()?e=>{const l=x()?y().find(r=>t(I).toReferenceItem(r).value===e.value):e;return j()(l)}:void 0,getTooltip:e=>e.description})),L;const ye=async e=>{if(m()&&e.trim()){a(S,!0);try{a(h,await m()(e),!0)}finally{a(S,!1)}}},pe=e=>{L&&clearTimeout(L),L=setTimeout(()=>ye(e),300)};function ve(e){a(G,e,!0),m()&&e.trim()?pe(e):e.trim()||a(h,[],!0)}const be=async e=>{if(M()){a(q,!0),a(f,null);try{const l=await M()(e);if(l){m()&&a(h,[...t(h),l],!0);const r=[...t(v),l];a(v,r,!0),H(r),a(w,!1)}else a(f,"Failed to create new item")}catch(l){a(f,l instanceof Error?l.message:"An error occurred",!0)}finally{a(q,!1)}}},ge=()=>{a(f,null),Ne(U),a(w,!0)};W(()=>{t(w)||a(f,null)});let ke=s(()=>!!M()&&t(G).trim());var J=Ee(),Q=E(J);{const e=d=>{var z=Ce(),N=E(z);{var V=_=>{var b=Le();b.__click=ge,Te(b,"aria-selected",!1);var T=A(b);qe(T,{type:"plus",size:"sm"});var o=O(T,2),g=A(o);{var P=k=>{var F=Z();X(()=>Y(F,`Create new ${p()??""}...`)),c(k,F)},he=k=>{var F=Z("Create new...");c(k,F)};R(g,k=>{p()?k(P):k(he,!1)})}c(_,b)};R(N,_=>{t(ke)&&_(V)})}c(d,z)};let l=s(()=>!m()),r=s(()=>!!m());Fe(Re(Q,{get adapter(){return t(me)},get placeholder(){return te()},get required(){return ae()},get disabled(){return ie()},get menuOptions(){return t(ce)},get size(){return le()},get label(){return ne()},get helperText(){return re()},get feedback(){return se()},get maxItems(){return de()},onChange:H,onInputChange:ve,get isLoading(){return t(S)},get filterSuggestions(){return t(l)},get showNoResults(){return t(r)},ariaLabel:"Reference input",get value(){return t(v)},set value(d){a(v,d,!0)},additionalDropdownContent:e,$$slots:{additionalDropdownContent:!0}}),d=>a(K,d,!0),()=>t(K))}var xe=O(Q,2);Ve(xe,()=>t(U),e=>{{let l=s(()=>p()?`Create New ${$(p())}`:"Create New"),r=s(()=>p()?`Create ${$(p())}`:"Create");Se(e,{get title(){return t(l)},placeholder:"Enter name",required:!0,get okText(){return t(r)},cancelText:"Cancel",onOk:be,onCancel:()=>{a(f,null)},get open(){return t(w)},set open(d){a(w,d,!0)},children:(d,z)=>{var N=Be(),V=E(N);{var _=o=>{var g=ze(),P=A(g);X(()=>Y(P,t(f))),c(o,g)};R(V,o=>{t(f)&&o(_)})}var b=O(V,2);{var T=o=>{var g=Pe();c(o,g)};R(b,o=>{t(q)&&o(T)})}c(d,N)},$$slots:{default:!0}})}}),c(ee,J),_e()}Ie(["click"]);Oe.__docgen={data:[{name:"value",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"T[]"},static:!1,readonly:!1,defaultValue:"..."},{name:"items",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"T[]"},static:!1,readonly:!1,defaultValue:"..."},{name:"fieldNames",visibility:"public",description:`Maps database field names to ReferenceItem properties.
Use this when your data uses different field names (e.g., 'name' instead of 'label').`,keywords:[],kind:"let",type:{kind:"type",type:"object",text:"FieldNameMapping"},static:!1,readonly:!1,defaultValue:"..."},{name:"search",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"SearchFunction"},static:!1,readonly:!1},{name:"createNew",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"CreateNewFunction<ReferenceItem>"},static:!1,readonly:!1},{name:"linkBuilder",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"LinkBuilderFunction"},static:!1,readonly:!1,defaultValue:"..."},{name:"resourceName",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"placeholder",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"Search and add items..."'},{name:"required",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"disabled",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"size",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"string",value:"xs",text:'"xs"'},{kind:"const",type:"string",value:"sm",text:'"sm"'},{kind:"const",type:"string",value:"md",text:'"md"'},{kind:"const",type:"string",value:"lg",text:'"lg"'},{kind:"const",type:"string",value:"xl",text:'"xl"'}],text:'"xs" | "sm" | "md" | "lg" | "xl"'},static:!1,readonly:!1,defaultValue:'"md"'},{name:"label",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"helperText",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"feedback",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"intersection",text:"FormFieldMessage & { details?: FormFieldMessage[] | undefined; }"},static:!1,readonly:!1,defaultValue:"..."},{name:"maxItems",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"..."},{name:"onChange",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(value: T[]) => void"},static:!1,readonly:!1,defaultValue:"..."}],name:"reference-box.svelte"};export{Oe as R};
